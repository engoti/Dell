// models/Appointment.js
const { DataTypes } = require('sequelize');
const sequelize = require('../config/config');

const Appointment = sequelize.define('Appointment', {
    id: { type: DataTypes.INTEGER, autoIncrement: true, primaryKey: true },
    patientId: { type: DataTypes.INTEGER, allowNull: false },
    doctorId: { type: DataTypes.INTEGER, allowNull: false },
    date: { type: DataTypes.DATE, allowNull: false },
    status: { type: DataTypes.ENUM('scheduled', 'canceled', 'completed'), defaultValue: 'scheduled' },
});

module.exports = Appointment;


exports.getAppointments = async (req, res) => {
    try {
        const where = req.user.role === 'doctor' ? { doctorId: req.user.id } : { patientId: req.user.id };
        const appointments = await Appointment.findAll({ where });
        res.status(200).json({ appointments });
    } catch (error) {
        res.status(500).json({ error: 'Failed to retrieve appointments' });
    }
};
